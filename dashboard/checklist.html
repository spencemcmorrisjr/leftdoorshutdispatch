<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Driver Checklist | Left Door Shut Dispatch</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: system-ui, sans-serif;
  background: linear-gradient(180deg,#020617,#0f172a);
  color: #e5e7eb;
  padding: 20px;
}

.container {
  max-width: 900px;
  margin: auto;
}

h1 {
  text-align: center;
  margin-bottom: 20px;
}

.card {
  background: #020617;
  border-radius: 14px;
  padding: 20px;
  margin-bottom: 18px;
  box-shadow: 0 10px 30px rgba(0,0,0,.4);
}

.driver-name {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: 12px;
}

.row {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 8px 0;
}

.label {
  flex: 1;
}

.status {
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 700;
}

.complete {
  background: #22c55e;
  color: #022c22;
}

.missing {
  background: #ef4444;
  color: white;
}

a.doc {
  color: #38bdf8;
  font-size: 13px;
  text-decoration: none;
}
</style>
</head>

<body>
<div class="container">
  <h1>Driver Document Checklist</h1>
  <div id="drivers"></div>
</div>

<!-- Tabletop.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.4/tabletop.min.js"></script>
<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/1RUV1fa3QPfDCvUHlrLSkHKDSI75dlBFRb-tGP8lOhN8";

function statusRow(label, value) {
  if (value && value.trim() !== "") {
    return `
      <div class="row">
        <div class="label">${label}</div>
        <div class="status complete">RECEIVED</div>
        <a class="doc" href="${value}" target="_blank">View</a>
      </div>`;
  } else {
    return `
      <div class="row">
        <div class="label">${label}</div>
        <div class="status missing">MISSING</div>
      </div>`;
  }
}

function agreementStatus(label, value) {
  if (value && value.trim().toLowerCase() === "yes") {
    return `
      <div class="row">
        <div class="label">${label}</div>
        <div class="status complete">SIGNED</div>
      </div>`;
  } else {
    return `
      <div class="row">
        <div class="label">${label}</div>
        <div class="status missing">MISSING</div>
      </div>`;
  }
}

function renderDrivers(data) {
  const container = document.getElementById("drivers");

  data.forEach(d => {
    container.innerHTML += `
      <div class="card">
        <div class="driver-name">${d.Name || "Unnamed Driver"}</div>
        ${statusRow("W-9", d["W9"])}
        ${statusRow("CDL", d["License"])}
        ${statusRow("Insurance", d["Insurance"])}
        ${agreementStatus("Driver Agreement", d["Driver Agreement Signed"])}
      </div>
    `;
  });
}

// Initialize Tabletop
Tabletop.init({
  key: SHEET_URL,
  simpleSheet: false,
  wanted: ["Operating Documents"],
  callback: function(data, tabletop) {
    const sheetData = tabletop.sheets("Operating Documents").all();
    renderDrivers(sheetData);
  },
  debug: false
});
</script>
</body>
</html>
